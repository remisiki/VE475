\documentclass[12pt]{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
% \usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage[margin=2.54cm]{geometry}
\usepackage[section]{placeins}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{caption}
\usepackage{csquotes}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{float}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{indentfirst}
\usepackage{multirow}
\usepackage{subcaption}
\title{VE475 Homework 6}
\author{Yiwen Yang}


\begin{document}
\date{}
\maketitle

\section*{Ex. 1 - Application of the DLP}

	\begin{enumerate}
		\item
			\begin{enumerate}
				\item
					With $r$, Alice can calculate $\alpha^r$, which should be the same as $\gamma\bmod p$.

					With $x+r\bmod(p-1)$, since $\alpha^{p-1}\equiv 1\bmod p$, then $\alpha^{x+r\bmod(p-1)}\equiv\alpha^{x+r}\equiv\alpha^x\alpha^r\bmod p$, which should be the same as $\beta\cdot\gamma$.

					So $r$ and $x+r\bmod(p-1)$ are considered so that Alice can operate on it to verify the results.
				\item
					If Alice requests $r$, she will never know $x$; If Alice requests $x+r$, she cannot know $x$ either without knowing $r$, because she only knows $\beta=\alpha^x$ and $\gamma=\alpha^r$ separately both of which is hard to solve. So Alice cannot cheat to get $x$ by requesting $r$ or $x+r$.

					If Bob does not know the true $x$, there is no way to answer $x+r$, thus Bob cannot cheat either. On the other hand, if Bob can correctly answer both $r$ and $x+r$, then he definitely knows $x$, so he can prove his identity.
			\end{enumerate}
		\item
			\begin{enumerate}
				\item 128 times.
				\item 256 times.
			\end{enumerate}
		\item Digital Signature.
	\end{enumerate}

\section*{Ex. 2 - Pohlig-Hellman}

	Let $g$ be a generator of a cyclic group $G$ with order $n$, for $h$ in $G$, find $x\in\{0,\ldots,n-1\}$ such that $g^x=h$.
	\begin{enumerate}
		\item Factorize $n=\Pi_{i=1}^r {p_i}^{e_i}$.
		\item Repeat Step 3 to 5 for all $i\in\{1,\ldots,r\}$.
		\item Compute $g_i=g^{n/{p_i}^{e_i}}$.
		\item Compute $h_i=h^{n/{p_i}^{e_i}}$.
		\item Find $x_i\in\{0,\ldots,{p_i}^{e_i}-1\}$ such that ${g_i}^{x_i}={h_i}$.
		\item Use Chinese Remainder Theorem to solve $x\equiv x_i \bmod {p_i}^{e_i}$.
	\end{enumerate}

	In this example, $n=28\times29^2=2^2\times7\times29^2$, $g=3$, $h=3344$.
	\begin{enumerate}
		\item $p_0=2$, $e_0=2$, $g_0=10133$, $h_0=24388$, $x_0=2$.
		\item $p_1=7$, $e_1=1$, $g_1=7032$, $h_1=4850$, $x_1=2$.
		\item $p_2=29$, $e_2=2$, $g_2=11369$, $h_2=23114$, $x_2=260$.
	\end{enumerate}

	Then calculate $7\times841\times3\equiv1\bmod4$, $4\times841\times2\equiv1\bmod7$, $4\times7\times811\equiv1\bmod841$, so $x\equiv7\times841\times3\times2+4\times841\times2\times2+4\times7\times811\times260\equiv18762\bmod23548$.

\section*{Ex. 3 - Elgamal}

	\begin{enumerate}
		\item
			Suppose that $X^3+2X^2+1$ is irreducible in $F_3[x]$, then
			$$X^3+2X^2+1=(X+A)(X^2+BX+C)=X^3+(A+B)X^2+(AB+C)X+AC$$
			$$AC=1$$
			If $A=C=1$, then $B+1=2$, $B+1=0$ contradicts.

			If $A=C=2$, then $B+2=2$, $2B+2=0$ also contradicts.

			So $X^3+2X^2+1$ is irreducible in $F_3[x]$ with degree 3, and we can conclude that $F_{3^3}$ is a finite field with $3^3=27$ elements.
		\item
			$X$ is a generator of $F_{3^3}$. First let $a=1,b=2,\ldots,z=26$, then the map can be defined as $c \rightarrow f(c):f(c)=X^c\bmod(X^3+2X^2+1)$.
		\item
			The order is 26.
		\item
			$X^{11}\equiv X+2\bmod(X^3+2X^2+1)$, then public key is $X+2$.
		\item
			First convert "goodmorning" into $F_{3^3}$, yielding $\{1+X^2,2X^2,2X^2,2+2X+X^2,2,2X^2,1+X,2X,2+2X+2X^2,2X,1+X^2\}$.

			Randomly pick $k=23$, $r\equiv X^{23}\equiv(2+X+2X^2)\bmod(X^3+2X^2+1)$, $t\equiv(X+2)^{23}m\equiv(X+X^2)m\bmod(X^3+2X^2+1)$. Then the cipher text is $\{1,2+X+X^2,2+X+X^2,2+X+2 X^2,2 X+2 X^2,2+X+X^2,2+X,1+X^2,X^2,1+X^2,1\}$, mapping to "zhhwfhkgbgz".

			To decrypt, calculate $r^{-1}=2+X^2$, $tr^{-x}\equiv t(2+X^2)^{11}\equiv 1+X^2\bmod(X^3+2X^2+1)$. The result plain text is $\{1+X^2,2X^2,2X^2,2+2X+X^2,2,2X^2,1+X,2X,2+2X+2X^2,2X,1+X^2\}$, mapping to "goodmorning", which is correct.
	\end{enumerate}

\section*{Ex. 4 - Simple Questions}

	\begin{enumerate}
		\item
			\begin{enumerate}
				\item $h$ is pre-image resistant. To reversely find $x$ is to solve Quadratic Residuosity Problem, which is very difficult with large primes $p$ and $q$.
				\item $h$ is not second pre-image resistant. Given $x$, $h(-x)=h(x)$.
				\item $h$ is not collision resistant. For every $x$, $h(-x)=h(x)$.
			\end{enumerate}
		\item
			\begin{enumerate}
				\item $h$ can be efficiently computed for any input. 
				\item $h$ is not pre-image resistant. To reversely find $m$, simply calculate $h(h(m))$.
				\item $h$ is not second pre-image resistant. Given $m$, let $n=m\mathbin\Vert\{160'b0\}$, then $h(m)=h(n)$.
				\item $h$ is not collision resistant. For every $m$, let $n=m\mathbin\Vert\{160'b0\}$, then $h(m)=h(n)$.
			\end{enumerate}
	\end{enumerate}

\section*{Ex. 5 - Merkle-Damg√•rd Construction}

	See in \textbf{H7}.

\section*{Ex. 6 - Programming}

	See in folder \textbf{ex6}.

\end{document}